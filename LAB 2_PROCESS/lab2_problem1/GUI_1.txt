# Táº¡o thÆ° má»¥c lÃ m viá»‡c
mkdir lab2_problem1
cd lab2_problem1

# Copy 2 file dá»¯ liá»‡u vÃ o Ä‘Ã¢y (vÃ­ dá»¥: u1.base, u1.test)
# Hoáº·c file1.txt, file2.txt cá»§a báº¡n

# Táº¡o file problem1.c
nano problem1.c
# (Copy code tá»« artifact vÃ o)

# Táº¡o Makefile (optional)
nano Makefile

# CÃ¡ch 1: DÃ¹ng Makefile
make
make all
# CÃ¡ch 2: Compile trá»±c tiáº¿p
gcc -Wall -g -o problem1 problem1.c


# Cháº¡y
./problem1 <tÃªn_file_1> <tÃªn_file_2>
# VÃ­ dá»¥:
./problem1 movie-100k_1.txt movie-100k_2.txt
```

## **BÆ°á»›c 5: Xem káº¿t quáº£**

typedef struct {
    double average_rating;  // Káº¿t quáº£ average
    int total_ratings;      // Tá»•ng sá»‘ ratings
    int is_ready;          // Flag Ä‘Ã¡nh dáº¥u hoÃ n thÃ nh
} SharedData;
```

### **2. Flow chÆ°Æ¡ng trÃ¬nh:**
```
Parent Process
    â”‚
    â”œâ”€â†’ Create Shared Memory (shmget, shmat)
    â”‚
    â”œâ”€â†’ Fork Child 1
    â”‚       â””â”€â†’ Read file1.txt
    â”‚       â””â”€â†’ Calculate average
    â”‚       â””â”€â†’ Write to shared_data[0]
    â”‚       â””â”€â†’ Exit
    â”‚
    â”œâ”€â†’ Fork Child 2
    â”‚       â””â”€â†’ Read file2.txt
    â”‚       â””â”€â†’ Calculate average
    â”‚       â””â”€â†’ Write to shared_data[1]
    â”‚       â””â”€â†’ Exit
    â”‚
    â”œâ”€â†’ Wait for both children (waitpid)
    â”‚
    â”œâ”€â†’ Read results from shared memory
    â”‚
    â”œâ”€â†’ Calculate overall average
    â”‚
    â””â”€â†’ Cleanup (shmdt, shmctl)
```

### **3. Key APIs sá»­ dá»¥ng:**
- `shmget()` - Táº¡o shared memory
- `shmat()` - Attach vÃ o address space
- `fork()` - Táº¡o child process
- `waitpid()` - Äá»£i child hoÃ n thÃ nh
- `shmdt()` - Detach shared memory
- `shmctl()` - XÃ³a shared memory

---

## **ğŸ“Š Output mong Ä‘á»£i:**
```
[Parent - PID 1234] Shared memory created with ID: 65536
[Parent - PID 1234] Shared memory attached at: 0x7f...

[Child 1 - PID 1235] Started processing file1.txt
[Child 2 - PID 1236] Started processing file2.txt

[Child 1 - PID 1235] Reading file: file1.txt
[Child 2 - PID 1236] Reading file: file2.txt
[Child 1 - PID 1235] Completed: Total ratings = 40000, Average = 3.5234
[Child 2 - PID 1236] Completed: Total ratings = 60000, Average = 3.5456

========== RESULTS ==========
File 1 (file1.txt):
  - Total ratings: 40000
  - Average rating: 3.5234

File 2 (file2.txt):
  - Total ratings: 60000
  - Average rating: 3.5456

Overall Statistics:
  - Total ratings: 100000
  - Overall average rating: 3.5367
=============================

[Parent] Shared memory cleaned up successfully







make clean 
make all